syntax = "proto3";

package rxdaq;

service ControlCrate {
	rpc Initialize(EmptyMessage) returns (InitializeReply) {}
	rpc Boot (BootRequest) returns (EmptyReply) {}
	rpc ReadParameter (ReadRequest) returns (ReadReply) {}
	rpc WriteParameter (WriteRequest) returns (EmptyReply) {}
	rpc ImportParameters (ImportExportRequest) returns (EmptyReply) {}
	rpc ExportParameters (ImportExportRequest) returns (EmptyReply) {}
	rpc StartRun (RunRequest) returns (RunReply) {}
	rpc StopRun (EmptyMessage) returns (RunReply) {}
}

enum ExceptionType {
	UNDEFINED = 0;
	FATALERROR = 1;
	WARNING = 2;
};


message EmptyMessage {
}

message InitializeReply {
	uint32 num = 1;
	ExceptionType exception_type = 2;
	string message = 3;
}

message BootRequest {
	uint32 module = 1;
	bool fast = 2;
}

message EmptyReply {
	ExceptionType exception_type = 1;
	string message = 2;
}


message ReadRequest {
	string name = 1;
	uint32 type = 2;
	uint32 module = 3;
	uint32 channel = 4;
}

message ReadReply {
	uint32 module_value = 1;
	double channel_value = 2;
	ExceptionType exception_type = 3;
	string message = 4;
}


message WriteRequest {
	string name = 1;
	uint32 type = 2;
	uint32 module_value = 3;
	double channel_value = 4;
	uint32 module = 5;
	uint32 channel = 6;
}


message ImportExportRequest {
	string path = 1;
}


message RunRequest {
	uint32 module = 1;
	uint32 seconds = 2;
	int32 run_number = 3;
}


message RunReply {
	uint32 seconds = 1;
	int32 run_number = 2;
	ExceptionType exception_type = 3;
	string message = 4;
}